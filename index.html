<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>PIO ğŸŒ™ Lunar $TSUKI Dashboard</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  body { margin:0; font-family: Arial, sans-serif; background: radial-gradient(circle at top, #0b0b1a, #000); color: #e6ffe6; }
  header { padding: 20px; text-align:center; }
  h1 { margin-bottom:5px; }
  .contract { font-size:12px; opacity:0.8; word-break: break-all; }
  .container { max-width:1200px; margin:auto; padding:20px; display:grid; grid-template-columns:1fr 1fr; gap:25px; }
  #pio-zone { margin:20px auto; text-align:center; }
  #pio-face { width:180px; transition: transform 0.4s ease; }
  #pio-mood { margin-top:10px; font-size:18px; opacity:0.9; }
  .pio-happy { transform: scale(1.05); }
  .pio-laugh { transform: scale(1.15) rotate(2deg); }
  .pio-sing { animation: pioBounce 0.6s infinite; }
  @keyframes pioBounce { 0%{transform:translateY(0);}50%{transform:translateY(-12px);}100%{transform:translateY(0);} }
  .panel { background: rgba(0,0,0,0.6); padding:20px; border-radius:18px; box-shadow:0 0 30px #00ff88, 0 0 60px #00ff88 inset; border:2px solid #00ff88; }
  .health-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:15px; }
  .health-card, .lunar-card { background: rgba(0,255,136,0.05); border-radius:14px; padding:15px; text-align:center; border:1px solid #00ff88; box-shadow:0 0 15px #00ff88 inset; }
  .health-title, .lunar-title { font-size:13px; opacity:0.7; margin-bottom:6px; }
  .health-value, .lunar-value { font-size:18px; font-weight:bold; }
  .health-good { color:#8cffc1; }
  .health-mid { color:#a0ffb8; }
  .health-bad { color:#ff6a6a; }
  .buttons { margin:20px 0; text-align:center; }
  button { background: linear-gradient(135deg, #00ff88, #00cc66); border:none; color:#000; padding:14px 22px; margin:10px; border-radius:30px; font-size:16px; cursor:pointer; box-shadow:0 0 20px #00ff88; font-weight:bold; }
  button:hover { transform: scale(1.05); box-shadow:0 0 30px #00ff88; }
  #moonOutput { margin-top:15px; font-size:18px; min-height:40px; text-align:center; }
  #lunar-panel { display:flex; flex-direction:column; gap:15px; }
  canvas { display:block; margin:auto; background: rgba(0,255,136,0.02); border-radius: 50%; }
  footer { opacity:0.5; font-size:12px; margin:20px; text-align:center; }
</style>
</head>

<body>

<header>
  <h1>PIO ğŸŒ™ $TSUKI Lunar Dashboard</h1>
  <div class="contract">
    $TSUKI Contract (Solana):<br>
    463SK47VkB7uE7XenTHKiVcMtxRsfNE2X4Q9wByaURVA
  </div>
</header>

<div class="container">

  <!-- LEFT COLUMN -->
  <div>
    <div id="pio-zone">
      <img id="pio-face" src="pio-images/pio-neutral.png" />
      <div id="pio-mood">PIO is calm ğŸŒ™</div>
    </div>

    <div class="panel" id="pio-chart-panel">
      <h3 style="text-align:center;">ğŸ“Š $TSUKI Live Price & Candle</h3>
      <canvas id="candleChart" width="400" height="250"></canvas>
      <div id="tsukiPrice" style="font-size:24px; margin:10px 0; color:#00ff88;">Loading priceâ€¦</div>
    </div>

    <div class="panel" id="pio-health">
      <div class="health-grid">
        <div class="health-card">
          <div class="health-title">ğŸ©º PIO Health</div>
          <div id="pioHealth" class="health-value health-mid">Stable</div>
        </div>
        <div class="health-card">
          <div class="health-title">ğŸŸ PIO Arena</div>
          <div id="pioArena" class="health-value">Neutral Zone ğŸŒ—</div>
        </div>
        <div class="health-card">
          <div class="health-title">ğŸŒ± Environment</div>
          <div id="pioEnv" class="health-value health-mid">Uncertain</div>
        </div>
        <div class="health-card">
          <div class="health-title">ğŸ§¬ PIO Age</div>
          <div id="pioAge" class="health-value">Loadingâ€¦</div>
        </div>
      </div>
    </div>

    <div class="buttons">
      <button onclick="rewardPIO()">ğŸŒ™ Reward PIO</button>
    </div>

    <div id="moonOutput">ğŸŒ™ Awaiting lunar action...</div>
  </div>

  <!-- RIGHT COLUMN: Lunar Consultation -->
  <div class="panel" id="lunar-panel">
    <div class="lunar-card">
      <div class="lunar-title">ğŸŒ• Lunar Matrix</div>
      <div id="lunarMatrix" class="lunar-value">Loading...</div>
    </div>
    <div class="lunar-card">
      <div class="lunar-title">ğŸ“… Lunar Calendar Numbers</div>
      <div id="lunarNumbers" class="lunar-value">Loading...</div>
    </div>
    <div class="lunar-card">
      <div class="lunar-title">â™ˆ Lunar Signs</div>
      <div id="lunarSigns" class="lunar-value">Loading...</div>
    </div>
    <canvas id="lunarCircle" width="250" height="250"></canvas>
  </div>

</div>

<footer>
  $TSUKI Lunar Dashboard â€¢ Live on Solana â€¢ Trust-based ğŸŒ™
</footer>

<script>
const LAUNCH_DATE = new Date("2024-05-11T00:00:00Z");
const MORALIS_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6IjMzODk3ZjUxLTkyZDItNGIyYS1iZTliLWMzMzc3NmYwNDYxYyIsIm9yZ2lkIjoiNjg3MTQiLCJ1c2VySWQiOiI2ODM2MiIsInR5cGVJZCI6IjNiZGY4MzA4LTI2YjAtNDgxOS05YjRhLWQyNDIzNTg2MjFjNyIsInR5cGUiOiJQUk9KRUNUIiwiaWF0IjoxNzY3OTUxNzE0LCJleHAiOjQ5MjM3MTE3MTR9._YDN2nwX_mRdJO2CzfScLny-q7KV4H0mFfs7oQrHB3U";
const TOKEN_ADDRESS = "463SK47VkB7uE7XenTHKiVcMtxRsfNE2X4Q9wByaURVA";

// Update PIO Age
function updateAge(){
  const days = Math.floor((new Date() - LAUNCH_DATE)/86400000);
  const months = Math.floor(days/30.44);
  document.getElementById("pioAge").innerText = `${months} months (${days} days)`;
}

// Reward PIO
async function rewardPIO(){
  const output=document.getElementById("moonOutput");
  output.innerHTML="ğŸŒ• Sending lunar signal...";
  try{
    const res=await fetch("https://ampedmyc.pythonanywhere.com/reward",{method:"POST"});
    if(!res.ok)throw new Error("HTTP "+res.status);
    const data=await res.json();
    let html=`PIO received <strong>${data.treats.length} ğŸŒ™ Lunar Treat(s)</strong><br>`;
    data.treats.forEach((t,i)=>{ html += `ğŸŒ™ Treat ${i+1}: Energy ${t.energy}<br>`; });
    output.innerHTML=html;
  }catch(err){ console.error(err); output.innerHTML="âš ï¸ Lunar Treat Engine unreachable.";}
}

// Health & Mood
function updateHealth(change){
  const h=document.getElementById("pioHealth");
  const a=document.getElementById("pioArena");
  const e=document.getElementById("pioEnv");
  h.className="health-value"; e.className="health-value";
  if(change>3){ h.innerText="Thriving ğŸš€"; h.classList.add("health-good"); a.innerText="Moon Arena ğŸŒ•"; e.innerText="Bullish"; e.classList.add("health-good"); }
  else if(change>0.5){ h.innerText="Healthy ğŸ˜º"; h.classList.add("health-good"); a.innerText="Memecoin Season ğŸŒˆ"; e.innerText="Optimistic"; e.classList.add("health-mid"); }
  else if(change>-1){ h.innerText="Stable ğŸŒ™"; h.classList.add("health-mid"); a.innerText="Neutral Zone ğŸŒ—"; e.innerText="Uncertain"; e.classList.add("health-mid"); }
  else{ h.innerText="Under Stress ğŸ˜¿"; h.classList.add("health-bad"); a.innerText="Shadow Arena ğŸŒ‘"; e.innerText="Bearish"; e.classList.add("health-bad"); }
}

function updatePIO(change){
  const face=document.getElementById("pio-face");
  const mood=document.getElementById("pio-mood");
  face.className="";
  if(change<-2){ face.src="pio-images/pio-sad.png"; mood.innerText="PIO feels sad ğŸ˜¿"; }
  else if(change<-0.5){ face.src="pio-images/pio-worried.png"; mood.innerText="PIO is worried ğŸ˜Ÿ"; }
  else if(change<0.5){ face.src="pio-images/pio-neutral.png"; mood.innerText="PIO is calm ğŸŒ™"; }
  else if(change<3){ face.src="pio-images/pio-happy.png"; face.classList.add("pio-happy"); mood.innerText="PIO is happy ğŸ˜º"; }
  else if(change<7){ face.src="pio-images/pio-laugh.png"; face.classList.add("pio-laugh"); mood.innerText="PIO is laughing ğŸ˜¹"; }
  else{ face.src="pio-images/pio-sing.png"; face.classList.add("pio-sing"); mood.innerText="PIO ENTERED AP MODE ğŸ¤ğŸ”¥"; }
}

// Lunar Panel
function updateLunarPanel(){
  const matrix = Math.floor(Math.random()*99+1);
  const numbers = Array.from({length:6},()=>Math.floor(Math.random()*30+1));
  const signs=["ğŸŒ‘ New Moon","ğŸŒ“ First Quarter","ğŸŒ• Full Moon","ğŸŒ— Last Quarter"];
  const currentSign = signs[Math.floor(Math.random()*signs.length)];
  document.getElementById("lunarMatrix").innerText = matrix;
  document.getElementById("lunarNumbers").innerText = numbers.join(" - ");
  document.getElementById("lunarSigns").innerText = currentSign;

  const canvas=document.getElementById("lunarCircle");
  const ctx=canvas.getContext("2d");
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.strokeStyle="#00ff88";
  ctx.lineWidth=4;
  ctx.beginPath();
  ctx.arc(125,125,100,0,Math.PI*2);
  ctx.stroke();
  ctx.fillStyle="#00ff88";
  numbers.forEach((n,i)=>{
    const angle=(i/6)*Math.PI*2-Math.PI/2;
    const x=125+Math.cos(angle)*100;
    const y=125+Math.sin(angle)*100;
    ctx.beginPath();
    ctx.arc(x,y,10,0,Math.PI*2);
    ctx.fill();
  });
}

// ğŸ•¯ Chart.js Candle Setup
let candleChart = null;
let candleData = [];
async function fetchCandleData(){
  try{
    const res=await fetch(`https://deep-index.moralis.io/api/v2/solana/ohlcv/${TOKEN_ADDRESS}?chain=solana&timeframe=10m&limit=20`,{
      headers: {"accept":"application/json","X-API-Key": MORALIS_KEY}
    });
    const data = await res.json();
    if(!data || !Array.isArray(data)) return;

    candleData = data.map(c=>({
      x: new Date(c.timestamp),
      o: parseFloat(c.open),
      h: parseFloat(c.high),
      l: parseFloat(c.low),
      c: parseFloat(c.close)
    }));

    // Update latest price display
    if(candleData.length) document.getElementById("tsukiPrice").innerText = `$TSUKI Price: $${candleData[candleData.length-1].c.toFixed(6)}`;

    // Render Chart
    if(!candleChart){
      const ctx=document.getElementById("candleChart").getContext("2d");
      candleChart = new Chart(ctx,{
        type: 'candlestick',
        data: {datasets:[{label:'$TSUKI',data:candleData}]},
        options:{plugins:{legend:{display:false}},scales:{x:{type:'time',time:{unit:'minute'}},y:{beginAtZero:false}}}
      });
    } else {
      candleChart.data.datasets[0].data = candleData;
      candleChart.update();
    }
  } catch(err){ console.error(err); }
}

// Simulate Market + PIO mood
function simulateMarket(){
  const change=(Math.random()-0.45)*8;
  updatePIO(change);
  updateHealth(change);
  updateLunarPanel();
}

updateAge();
fetchCandleData();
simulateMarket();

// ğŸ” Intervals
setInterval(fetchCandleData,10000); // update candle every 10 sec
setInterval(simulateMarket,10000); // PIO mood/health every 10 sec
</script>

</body>
</html>
